{
    "id": "on-demand-url-scan-schedule",
    "schedule": {
        "recurrenceInterval": "PT1M"
    },
    "jobSpecification": {
        "priority": 0,
        "constraints": {
            "maxWallClockTime": "PT1H",
            "maxTaskRetryCount": 0
        },
        "jobManagerTask": {
            "id": "on-demand-url-scan-job-manager-task",
            "commandLine": "cmd /c \"powershell.exe %AZ_BATCH_NODE_STARTUP_WORKING_DIR%\\prepare-run.ps1 && docker run --init --rm --workdir /app --env-file %AZ_BATCH_TASK_WORKING_DIR%\\.env -e APPINSIGHTS_INSTRUMENTATIONKEY %CONTAINER_REGISTRY_TOKEN%.azurecr.io/batch-scan-manager\"",
            "constraints": {
                "maxWallClockTime": "PT1H",
                "retentionTime": "P3D",
                "maxTaskRetryCount": 0
            },
            "killJobOnCompletion": true,
            "userIdentity": {
                "autoUser": {
                    "scope": "task",
                    "elevationLevel": "admin"
                }
            },
            "runExclusive": false
        },
        "commonEnvironmentSettings": [
            {
                "name": "APPINSIGHTS_INSTRUMENTATIONKEY",
                "value": "%APP_INSIGHTS_TOKEN%"
            },
            {
                "name": "AI_STORAGE_SCAN_QUEUE",
                "value": "ondemand-scanrequest"
            },
            {
                "name": "AI_STORAGE_NOTIFICATION_QUEUE",
                "value": "ondemand-send-notification"
            },
            {
                "name": "AI_KEY_VAULT_URL",
                "value": "%KEY_VAULT_TOKEN%"
            }
        ],
        "poolInfo": {
            "poolId": "on-demand-url-scan-pool"
        }
    }
}
